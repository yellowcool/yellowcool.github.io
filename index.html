<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="c_night">
<meta property="og:type" content="website">
<meta property="og:title" content="coolyellow的博客">
<meta property="og:url" content="http://www.coolcoolcoder.com/c_night/index.html">
<meta property="og:site_name" content="coolyellow的博客">
<meta property="og:description" content="c_night">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="coolyellow的博客">
<meta name="twitter:description" content="c_night">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.coolcoolcoder.com/c_night/"/>





  <title>coolyellow的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">coolyellow的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">cool</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2018/02/19/hadoop/hdfs工作机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/19/hadoop/hdfs工作机制/" itemprop="url">hdfs工作机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-19T10:34:45+08:00">
                2018-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hsdoop/" itemprop="url" rel="index">
                    <span itemprop="name">hsdoop</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h3><ol>
<li>HDFS集群分为两大角色：NameNode(Secondary NameNode)、DataNode</li>
<li>NameNode负责管理整个文件系统的元数据</li>
<li>DataNode负责管理用户文件的数据块</li>
<li>文件会按照固定大小(blocksize)切成若干块后分布式存储在若干台datanode上</li>
<li>每一个文件块会被分成多个副本分别存储在不同的datanode上</li>
<li>datanode会定期向NameNode汇报自身所保存的文件block信息，而NameNode则会负责保持文件的副本数量</li>
<li>HDFS的内部工作机制对客户端保持透明，客户端请求访问HDFS都是通过向NameNode申请来进行</li>
<li>HDFS写数据流程图<br><img src="/pics/HDFS写数据流程图.png" alt="HDFS写数据流程图"></li>
<li>HDFS读数据流程图<br><img src="/pics/HDFS读数据流程图.png" alt="HDFS读数据流程图"></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2018/01/04/linux/linux常用命令总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/04/linux/linux常用命令总结/" itemprop="url">linux常用命令总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-04T20:59:09+08:00">
                2018-01-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><h5 id="关于linux我们这里不深入研究，只总结一下常用的命令，以便为以后学习大数据打下基础。"><a href="#关于linux我们这里不深入研究，只总结一下常用的命令，以便为以后学习大数据打下基础。" class="headerlink" title="关于linux我们这里不深入研究，只总结一下常用的命令，以便为以后学习大数据打下基础。"></a>关于linux我们这里不深入研究，只总结一下常用的命令，以便为以后学习大数据打下基础。</h5><h3 id="二、linux常用基础"><a href="#二、linux常用基础" class="headerlink" title="二、linux常用基础"></a>二、linux常用基础</h3><ol>
<li>命令行字体变大<br>ctrl + shift + “+”</li>
<li>命令行字体变小<br>ctrl + “-“</li>
<li>查看当前所在路径<br>pwd</li>
<li>跳转到当前目录的上一级目录(当前目录的父目录)<br>cd .. </li>
<li>跳转到当前目录下的某一个目录<br>cd ./xxx’或者’cd xxx</li>
<li>回到上次的目录<br>cd -</li>
<li>回到当前用户的主目录下<br>cd ~</li>
<li>查看指定目录下的文件或者文件夹(不包括隐藏文件或者文件夹)<br>ls xxx</li>
<li>查看当前目录下的所有文件和文件夹(包括隐藏文件跟文件夹)<br>ls -a</li>
<li>查看当前目录下的文件和文件夹的详细信息<br>ls -l</li>
<li>查看当前目录下的文件和文件夹的格式化后的详细信息<br>ls -lh</li>
<li>查看当前目录下的所有以特殊清醒的文件或文件夹<br>ls *.txt //查看已后缀为txt的所有文件</li>
<li>自动补全<br>tab 单击时自动补全，双击时显示所有匹配成功的文件或者文件夹</li>
<li>清空当前的dos界面(并非真正意义上的清空，只是上移)<br>clear</li>
<li>查看当前dos窗口敲过的命令<br>history</li>
<li>创建文件<br>touch 文件名.后缀</li>
<li>重定向<br>“&gt;”（例如 ls -l &gt; test.txt,将详细信息保存到test.txt中，如果没有test.txt会重新创建，如果存在会删除其内容，然后再添加）<br>“&gt;&gt;” (例如 ls -l &gt;&gt; test.txt,将详细信息保存到test.txt中，如果没有会重新创建，如果存在会在文件末尾继续添加)</li>
<li>使用默认编辑器打开某一文件(gedit)<br>gedit xxx.txt</li>
<li>查看某一文件内容<br>cat xxx.txt</li>
<li>将两个文件内容合并到另一个文件中<br>cat 1.txt 2.txt &gt; 3.txt</li>
<li>创建文件夹<br>mkdir xxx</li>
<li>删除文件文件夹相关<ul>
<li>rmdir xxx //只能删除空文件夹</li>
<li>rm *.txt //删除某个文件</li>
<li>rm xxx -r //递归删除某个文件夹</li>
<li>rm *.txt -f //强制删除某个文件</li>
<li>rm *.txt -i //交互式删除某个文件，即删除前询问</li>
</ul>
</li>
<li>建立链接(源文件只能是文件不能是文件夹)<ul>
<li>硬链接：ln 源文件 链接文件(就是相当于给文件添加多个文件名，只有所有文件名都删除后才能真正的删除该文件)</li>
<li>软链接: ln -s 源文件 链接文件(不占用磁盘空间，源文件删除后，链接失效，相当于创建了快捷方式)</li>
</ul>
</li>
<li>搜索<ul>
<li>grep 搜索内容 搜索文件:grep “aa” 1.txt(搜索1.txt文件中的aa)</li>
<li>grep -n 搜索内容 搜索文件:grep -n “aa” 1.txt(搜索1.txt文件中的aa并显示所在行数)</li>
<li>grep -n 正则匹配规则 搜索文件:grep -n “^a”/“a$” 1.txt(搜索1.txt文件中的以a开头/以a结尾的内容，并显示所在行数)</li>
</ul>
</li>
<li>查找<br>find 要查找的目录 -name 要查找的文件：find xxx -name *.txt(查找xxx目录下的后缀名为txt的所有文件)</li>
<li>复制<ul>
<li>cp 要复制的文件 要复制到的文件夹路径: cp 1.txt test/(将1.txt文件复制到test文件夹下)</li>
<li>cp 要复制的文件 要复制到的文件夹路径 -v: cp 1.txt test/ -v (将1.txt文件复制到test文件夹下，并显示进度)</li>
<li>cp 要复制的文件夹 要复制到的文件夹路径 -a: cp test test2/ -a(将test文件夹整体复制到test2文件夹下)</li>
<li>cp 要复制的文件夹 要复制到的文件夹路径 -r: cp test test2/ -r(将test文件夹以递归的形式整体复制到test2文件夹下)</li>
</ul>
</li>
<li>移动(剪切)<ul>
<li>mv 要移动的文件 要移动到的文件夹路径: mv 1.txt test(将1.txt文件移动到test文件夹下)</li>
<li>mv 要移动的文件夹 要移动到的文件夹路径(-r可加可不加): mv test test2/(将test文件夹移动到test2文件夹下)</li>
<li>mv 1.txt 2.txt: 将文件1.txt改名为2.txt</li>
</ul>
</li>
<li><p>打包压缩减压缩<br>z:压缩    c:打包  x:减压  v：显示进度 f:指定档案名称，f后面必须是.tar，并且f必须放在选项最后</p>
<ul>
<li>tar -cvf test.tar 1.txt 2.txt 3.txt:将1.txt 2.txt 3.txt 打包成test.tar（只打包不压缩，大小不变）</li>
<li>tar -zcvf test.tar.gzip 1.txt 2.txt 3.txt:将1.txt 2.txt 3.txt 打包压缩成test.tar（即打包也压缩）</li>
<li>tar -xvf test.tar:减包test.tar</li>
<li>tar -zxvf test.tar.gzip:减压缩test.tar.gzip</li>
<li>tar -zxvf test.tar.gzip -C test/:减压缩test.tar.gzip到test目录下<br>bz2:</li>
<li>tar -jcvf test.tar.bz2 1.txt 2.txt 3.txt:将1.txt 2.txt 3.txt 打包压缩成test.tar.bz2（即打包也压缩）</li>
<li>tar -jxvf test.tar.bz2:减压缩test.tar.bz2</li>
</ul>
</li>
<li><p>gzip:压缩，减压</p>
<ul>
<li>gzip -r test.tar:压缩所有子目录到test.tar.gzip</li>
<li>gzip -d test.tar.gzip:减压缩test.tar.gzip</li>
</ul>
</li>
<li>zip unzip:压缩，减压缩<br>zip [-r] 目标文件（没有扩展名） 源文件 zip [-r] my 1.txt===&gt;my.zip<br>unzip -d 减压后目录文件 压缩文件:unzip -d test my.zip===&gt;将my.zip减压缩到test目录下</li>
<li>which：查看某个文件所在的目录<br>which ls:查看ls文件所在的目录</li>
<li>data：显示当前日期，时间<br>cal:显示当前日历 cal 2016:显示2016年的日历</li>
<li>ps:查看进程信息<ul>
<li>ps -a:显示终端上所有的进程，包括其他用户进程</li>
<li>ps -u：显示进程的详细状态</li>
<li>ps -x：显示没有控制终端的进程</li>
<li>ps -w：显示加宽，以便显示更多的信息</li>
<li>ps -r：只显示正在运行的进程<h5 id="常用的是-ps-aux"><a href="#常用的是-ps-aux" class="headerlink" title="常用的是 ps -aux"></a>常用的是 ps -aux</h5></li>
</ul>
</li>
<li>kill :杀死某个进程<br>先用ps -aux查看所有进程，然后kill 要杀死的进程前的编号（pid）<br>kill -9 pid:强制杀死某个进程</li>
<li>reboot：重启<ul>
<li>shutdown -r now:立刻重启</li>
<li>shutdown -h now:立刻关机</li>
<li>shutdown -h 20:35:在20:35时关机</li>
<li>shutdwon -h +10:10分钟后关机</li>
</ul>
</li>
<li>top：动态显示运行中的进程<br>按下top后可以根据如下按键得到队形的结果排序：<ul>
<li>M：根据内存使用量来排序</li>
<li>P:根据cup占有率来排序</li>
<li>T:根据进程运行时间长短来排序</li>
<li>U:可以根据后面输入的而用户名来筛选进程</li>
<li>K:可以根据后面输入的PID来杀死进程</li>
<li>q:退出</li>
<li>h:获得帮助</li>
</ul>
</li>
<li>df:查看磁盘的使用情况<br>df -lh:查看格式化后磁盘的使用情况</li>
<li>du:显示当前目录所占用的磁盘情况<br>du -alh:显示当前目录所有子目录所占磁盘的情况</li>
<li>ifconfig:查看当前PC的网卡信息等</li>
<li>ctrl+alt+f1~f6:进入非图形界面<ul>
<li>ctrl+alt+f7:进入图形界面</li>
<li>ctrl+alt:鼠标才能从非图形界面中出来</li>
</ul>
</li>
<li>ssh:远程登录<br>ssh 用户名@ip:远程登录某个用户名</li>
<li>who：查看当前登录的用户的信息<br>whoami:查看当前命令窗口是哪个用户在使用</li>
<li>useradd(adduser):添加用户（但是没有超级管理员，即不能使用sudo）<br>useradd yellowcool：添加用户名为yellowcool的用户，但没有家目录，即在home目录下没有yellowcool这个目录（一般每个用户在home中都有对应的目录）<br>useradd coolyellow -m:添加用户名为coolyellow的用户，并且在home目录下有其对应的目录</li>
<li>userdel:删除某个用户（该用户不能是正在登陆使用的，如果正在使用要exit再删除）<br>userdel 用户名：删除某个用户，但不删除其在home中的文件夹目录<br>userdel -r 用户名：删除某个用户，并且删除其在home中的文件夹目录</li>
<li>passwd:修改用户密码<br>passwd yellowcool:修改用户名为yellowcool的密码</li>
<li>su 用户名：切换到某个用户下</li>
<li>所有用户名都在/etc/passwd文件中<br>cat /etc/passwd查看</li>
<li>所有用户组都在/etc/group文件中<br>查看都有哪些用户组：<br> cat /etc/group或者groupmod 三次tab键</li>
<li>增加，删除组：<ul>
<li>groupadd 组名</li>
<li>groupdel 组名</li>
</ul>
</li>
<li>groups 用户名：查看用户名在哪个组中(只有在sudo组中的用户才具有超级管理员)<br>groups coolyellow</li>
<li>groupmod -g 用户组名 用户名：将某个用户添加到某个用户组中，会修改替换默认的用户组<ul>
<li>groupmod -G 用户组名 用户名：将某个用户添加到某个用户组中，会随机替换非默认用户组</li>
<li>groupmod -a -G 用户组名 用户名：将某个用户添加到某个用户组中,不修改任何用户组，直接添加到新的用户组中</li>
</ul>
</li>
<li>为创建的普通用户添加sudo权限，必须同时添加到adm跟sudo组中，必须在root用户下操作：<ul>
<li>sudo usermod -a -G adm 用户名</li>
<li>sudo usermod -a -G sudo 用户名（可能不需要sudo）</li>
</ul>
</li>
<li>chmod：修改权限(g:组 o:其他用户) <ul>
<li>chmod u+x 1.txt:为1.txt的拥有者添加可执行权限</li>
<li>chmod u-x 1.txt：修改拥有者为不可执行权限</li>
<li>chmod u=x 1.txt:修改拥有者的权限只为可执行</li>
<li>chmod 761 1.txt:该方式是最常用的<h5 id="注意：对于文件夹如果没有可执行权限，则进不去这个文件夹"><a href="#注意：对于文件夹如果没有可执行权限，则进不去这个文件夹" class="headerlink" title="注意：对于文件夹如果没有可执行权限，则进不去这个文件夹"></a>注意：对于文件夹如果没有可执行权限，则进不去这个文件夹</h5></li>
</ul>
</li>
<li>chown:修改文件的所有者<br>chown 用户名 文件或者目录名；</li>
<li>chgrp:修改文件所属组<br>chgrp 用户组名 文件或目录名</li>
<li>ubuntu软件安装与卸载：<br>1）修改Ubuntu默认的软件下载服务器，注意先备份<br> gedit /etc/apt/sources.list<br>2)从更新源地址：<a href="https://mirrors.tuna.tsinghua.edu.cn中找到Ubuntu对应的版本" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn中找到Ubuntu对应的版本</a><br> 然后复制到sources.list中的<a href="http://help.ubuntu.com...中，、" target="_blank" rel="external">http://help.ubuntu.com...中，、</a><br>3）执行apt-get update命令，验证是否成功（必须验证），让更新源生效<br>4）开始安装软件<br>   apt-get install 软件名<br>5）删除软件<br>   apt-get remove package</li>
<li>ftp服务器：文件上传下载协议（文件传输协议）<br>1）安装vsftpd服务器<br>  sudo apt-get install vsftpd<br>2)配置vsftpd.conf文件(验证上传文件是否合法)<br> sudo vi /etc/vsftpd.conf<br>3）重启FTP服务，使其生效<br> sudo /etc/init.d/vsftpd restart<br>4)登录ftp<br>5)上传或者下载文件<br> put somefile:上传某个文件<br> get somefile：下载某个文件</li>
<li>ssh服务器<br>1）安装ssh<br>sudo apt-get install openssh-server<br>2)远程登录<br> ssh 用户名@IP<br>3）远程拷贝<br> scp -r 目标用户名@目标主机IP：/目标文件的绝对路径   /保存到本机的绝对（或者相对）路径<br>① 本地文件复制到远程：（拷贝单个文件可以不加参数-r）<br>   scp filename remoteUserName@RemoteHostIp:RemoteFile<br>   scp filename RemoteHostIp:RemoteFile<br>② 本地目录复制到远程：<br>   scp -r foldername remoteUserName@RemoteHostIp:RemoteFolder<br>   scp -r foldername RemoteHostIp:RemoteFolder<br> ③ 远程文件复制到本地<br>   scp remoteUserName@RemoteHostIp:RemoteFile filename<br>   scp RemoteHostIp:RemoteFile  filename<br> ④ 远程目录复制到本地<br>   scp -r remoteUserName@RemoteHostIp:RemoteFolder  foldername<br>   scp -r RemoteHostIp:RemoteFolder  foldername </li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2017/12/23/hadoop/Hadoop安装与配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/23/hadoop/Hadoop安装与配置/" itemprop="url">Hadoop安装与配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-23T19:14:05+08:00">
                2017-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">hadoop</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、Hadoop安装"><a href="#一、Hadoop安装" class="headerlink" title="一、Hadoop安装"></a>一、Hadoop安装</h3><ol>
<li>下载Hadoop并减压到指定目录</li>
<li>配置Hadoop环境变量(注意这里的HADOOP_INSTALL不是必须配置的，只是为了方便以后我们调用hadoop目录，但不能设置为HADOOP_HOME因为hadoop会动态创建，如果我们也设置为HADOOP_HOME会干扰其创建)：<br> 在/etc目录下的environment中添加HADOOP_INSTALL=你所减压的Hadoop的目录（注意这里不包含”/“,例如：”/usr/soft/hadoop”;然后在path中添加bin跟sbin路径，例如：”:/usr/soft/hadoop/bin:/usr/soft/hadoop/sbin”）</li>
<li>使环境变量立即生效：<br> 执行”source environment”命令</li>
<li>查看Hadoop是否安装成功：<br> 执行”hadoop version”命令，如果没报错，并显示了Hadoop的版本则说明配置成功了（注意如果未安装jdk或未配置JAVA_HOME需要先安装跟配置jdk的环境变量，如果安装并配置了jdk仍然报错，可能需要重启系统来生效）<h3 id="二、Hadoop配置模式"><a href="#二、Hadoop配置模式" class="headerlink" title="二、Hadoop配置模式"></a>二、Hadoop配置模式</h3><h5 id="使用jps命令查看当前运行的java进程"><a href="#使用jps命令查看当前运行的java进程" class="headerlink" title="使用jps命令查看当前运行的java进程"></a>使用jps命令查看当前运行的java进程</h5></li>
</ol>
<ul>
<li>hadoop中输入命令行与Linux一样只是需要以”hadoop fs”开始(例如”hadoop fs -ls /“查看/下的所有文件及其文件夹)</li>
</ul>
<ol>
<li>独立模式:没有守护进程，所有程序呢运行在一个jvm上，适合开发期间运行mapreduce程序，易于测试和调试。<ul>
<li>配置:不需要配置，默认的配置就是独立模式。</li>
</ul>
</li>
<li>伪分布式模式:守护进程在本机上，模拟一个小规模的集群<br>(1) 配置:<br>首先我们需要配置一下hadoop_env.sh文件，将其中的JAVA_HOME配置到jdk所在目录<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export JAVA_HOME=/usr/soft/jdk1.8.0</div></pre></td></tr></table></figure>
</li>
</ol>
<p>然后设置一下配置文件，所有的配置文件都在Hadoop安装目录/etc/hadoop目录下，一般来说会将hadoop安装目录/etc/hadooop进行拷贝一份(比如起名为hadoop_pse),然后在拷贝的目录下设置配置文件内容，需要配置的内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&lt;!-- core-site.xml --&gt;//配置通用属性</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;fs.defaultFS&lt;/name&gt;</div><div class="line">&lt;value&gt;hdfs://localhost:9000/&lt;/value&gt;//namenode地址</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</div><div class="line">&lt;value&gt;/home/coolyellow/hadooptmp&lt;/value&gt;//临时文件目录</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div><div class="line"></div><div class="line">&lt;!-- hdfs-site.xml --&gt;//配置HDFS属性</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;dfs.replication&lt;/name&gt;//副本数量</div><div class="line">&lt;value&gt;1&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div><div class="line"></div><div class="line">&lt;!-- mapred-site.xml --&gt;//配置mapReduce属性</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;mapreduce.framework.name&lt;/name&gt;</div><div class="line">&lt;value&gt;yarn&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div><div class="line"></div><div class="line">&lt;!-- yarn-site.xml --&gt;//配置yarn属性</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;//配置yarn的总的管理地址</div><div class="line">&lt;value&gt;localhost&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</div><div class="line">&lt;value&gt;mapreduce_shuffle&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure></p>
<p> (2) 配置ssh：<br>因为伪分布模式需要启动守护进程，而启动守护进程的前提是已经安装了SSH。那么首先，我们要确认是否安装了ssh，在Linux下可以输入以下命令来测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install ssh</div></pre></td></tr></table></figure></p>
<p> 然后基于一个空口令创建一个新的SSH秘钥，用于免密登录：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -P &apos;&apos; -f ~/.ssh/id_rsa</div><div class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</div></pre></td></tr></table></figure></p>
<p> 最后测试是否免密登录成功：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh localhost</div></pre></td></tr></table></figure></p>
<p> 如果登录成功则证明配置成功<br> (3) 格式化HDFS文件系统<br> 在使用Hadoop之前必须要格式化生成一个全新的HDFS文件系统，该过程创建一个空文件系统，仅含存储目录和namenode持久化数据结构的初始版本。由于datenode可以动态的加入或者离开集群，所以这个格式化并不包含datenode。格式化HDFS文件系统只需要执行如下命令即可:<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop namenode -fromat</div></pre></td></tr></table></figure></p>
<p> (4) 启动守护进程<br> 执行如下命令：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">start-dfs.sh //启动名称节点，数据节点，辅助节点</div><div class="line">start-yarn.sh //启动节点管理器，资源管理器</div></pre></td></tr></table></figure></p>
<p> 也可以使用如下命令来代替上面两行的命令<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">start-all.sh</div></pre></td></tr></table></figure></p>
<p> 由于我们的配置文件在拷贝的hadoop_pse中，并非默认的配置路径，所以我们要在环境变量中配置HADOOP_CONF_DIR=我们配置的目录，或者通过config来动态配置<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">start-all.sh --config $HADOOP_INSTALL/etc/hadoop_pse//其中HADOOP_INSTALL是我们配置在环境变量中的Hadoop安装目录</div></pre></td></tr></table></figure></p>
<p>我们可以通过jps命令来查看启动的进程<br> (5) 创建文件测试<br> 如果以上配置都成功了，那么我们就可以对Hadoop进行操作了，这里我们只是创建一个文件夹进行测试<br> 首先要配置HADOOP_CONF_DIR,这里我们通过动态设置，执行如下命令<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export HADOOP_CONF_DIR=$HADOOP_INSTALL/etc/hadoop_pse</div></pre></td></tr></table></figure></p>
<p> 然后执行创建文件夹命令<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop fs -mkdir /user/</div></pre></td></tr></table></figure></p>
<p> 最后查看是否创建成功：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop fs -ls /</div></pre></td></tr></table></figure></p>
<p> 如果显示了user文件夹，则说明配置成功了。<br> (6) 停止守护进程<br> 执行如下命令：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">stop-dfs.sh</div><div class="line">stop-yarn.sh</div></pre></td></tr></table></figure></p>
<p> 也可以使用如下命令停止守护进程：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">stop-all.sh</div></pre></td></tr></table></figure></p>
<ol>
<li><p>完全分布式模式:守护进程运行在多个主机的集群上。<br>(1)配置：</p>
<ul>
<li>建立然链接</li>
<li>配置虚拟器免密码互登<br>  只需要将master节点的公匙传输的slave中，并在slave中将ssh公匙加入            授权;</li>
</ul>
<p>(2)修改config参数,这里的参数配置与伪分布基本相同，在后面的表格中会详细说明。<br>(3)剩下的基本与伪分布配置相同。</p>
</li>
</ol>
<h3 id="三、Hadoop配置文件说明"><a href="#三、Hadoop配置文件说明" class="headerlink" title="三、Hadoop配置文件说明"></a>三、Hadoop配置文件说明</h3><p><img src="/pics/配置文件.png" alt="config配置文件说明"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2017/12/23/linux/ubuntu代理设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/23/linux/ubuntu代理设置/" itemprop="url">ubuntu代理设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-23T16:15:37+08:00">
                2017-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ubuntu/" itemprop="url" rel="index">
                    <span itemprop="name">ubuntu</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.修改ubuntu代理</p>
<h5 id="进入etc-apt中备份source-list文件，然后拷贝其他代理到souorce-list中，保存后，执行sudo-apt-get-update进行更新源"><a href="#进入etc-apt中备份source-list文件，然后拷贝其他代理到souorce-list中，保存后，执行sudo-apt-get-update进行更新源" class="headerlink" title="进入etc/apt中备份source.list文件，然后拷贝其他代理到souorce.list中，保存后，执行sudo apt-get update进行更新源"></a>进入etc/apt中备份source.list文件，然后拷贝其他代理到souorce.list中，保存后，执行sudo apt-get update进行更新源</h5>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2017/11/12/android/Android消息机制从源码分析Handelr、Looper、Message/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/12/android/Android消息机制从源码分析Handelr、Looper、Message/" itemprop="url">Android消息机制从源码分析Handelr、Looper、Message</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-12T10:24:12+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><h5 id="关于Android消息机制想必大家都非常熟悉了，而且面试必问问题之一，如果我们仍旧只是知道怎么使用，那就太更不上时代步伐了，想想当面试问你handler机制时，你从源码给其分析一遍，那你已经踏进offer大门一只左脚了，所以这里我们一起从源码查看一下消息机制。"><a href="#关于Android消息机制想必大家都非常熟悉了，而且面试必问问题之一，如果我们仍旧只是知道怎么使用，那就太更不上时代步伐了，想想当面试问你handler机制时，你从源码给其分析一遍，那你已经踏进offer大门一只左脚了，所以这里我们一起从源码查看一下消息机制。" class="headerlink" title="关于Android消息机制想必大家都非常熟悉了，而且面试必问问题之一，如果我们仍旧只是知道怎么使用，那就太更不上时代步伐了，想想当面试问你handler机制时，你从源码给其分析一遍，那你已经踏进offer大门一只左脚了，所以这里我们一起从源码查看一下消息机制。"></a>关于Android消息机制想必大家都非常熟悉了，而且面试必问问题之一，如果我们仍旧只是知道怎么使用，那就太更不上时代步伐了，想想当面试问你handler机制时，你从源码给其分析一遍，那你已经踏进offer大门一只左脚了，所以这里我们一起从源码查看一下消息机制。</h5><h2 id="二、源码解析"><a href="#二、源码解析" class="headerlink" title="二、源码解析"></a>二、源码解析</h2><h3 id="1、ActivityThread-main-方法跟Looper"><a href="#1、ActivityThread-main-方法跟Looper" class="headerlink" title="1、ActivityThread.main()方法跟Looper"></a>1、ActivityThread.main()方法跟Looper</h3><h5 id="我刚接触android时，大家都跟我说application的oncreate方法是，APP的入口，但这其实是不正确的，APP的真正的入口是ActivityThread类的main方法，这里要注意虽然叫ActivityThread其实它并不是我们平时所说的线程，由于我们这里只是分析消息机制，所以感兴趣的小伙伴可以自己去查询一下相关知识，既然main方法是入口，那我们就看看APP在启动时都做了什么，源码如下："><a href="#我刚接触android时，大家都跟我说application的oncreate方法是，APP的入口，但这其实是不正确的，APP的真正的入口是ActivityThread类的main方法，这里要注意虽然叫ActivityThread其实它并不是我们平时所说的线程，由于我们这里只是分析消息机制，所以感兴趣的小伙伴可以自己去查询一下相关知识，既然main方法是入口，那我们就看看APP在启动时都做了什么，源码如下：" class="headerlink" title="我刚接触android时，大家都跟我说application的oncreate方法是，APP的入口，但这其实是不正确的，APP的真正的入口是ActivityThread类的main方法，这里要注意虽然叫ActivityThread其实它并不是我们平时所说的线程，由于我们这里只是分析消息机制，所以感兴趣的小伙伴可以自己去查询一下相关知识，既然main方法是入口，那我们就看看APP在启动时都做了什么，源码如下："></a>我刚接触android时，大家都跟我说application的oncreate方法是，APP的入口，但这其实是不正确的，APP的真正的入口是ActivityThread类的main方法，这里要注意虽然叫ActivityThread其实它并不是我们平时所说的线程，由于我们这里只是分析消息机制，所以感兴趣的小伙伴可以自己去查询一下相关知识，既然main方法是入口，那我们就看看APP在启动时都做了什么，源码如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">  public static void main(String[] args) &#123;</div><div class="line">//省略代码</div><div class="line">......</div><div class="line">       Looper.prepareMainLooper();</div><div class="line"></div><div class="line">       ActivityThread thread = new ActivityThread();</div><div class="line">       thread.attach(false);</div><div class="line"></div><div class="line">       if (sMainThreadHandler == null) &#123;</div><div class="line">           sMainThreadHandler = thread.getHandler();</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       if (false) &#123;</div><div class="line">           Looper.myLooper().setMessageLogging(new</div><div class="line">                   LogPrinter(Log.DEBUG, &quot;ActivityThread&quot;));</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       // End of event ActivityThreadMain.</div><div class="line">       Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);</div><div class="line">       Looper.loop();</div><div class="line"></div><div class="line">       throw new RuntimeException(&quot;Main thread loop unexpectedly exited&quot;);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h5 id="我们很容易注意到-Looper-prepareMainLooper-，Looper-loop-这两句代码，具体他们都是做什么的，我们一个一个来分析，先来看看第一句源码："><a href="#我们很容易注意到-Looper-prepareMainLooper-，Looper-loop-这两句代码，具体他们都是做什么的，我们一个一个来分析，先来看看第一句源码：" class="headerlink" title="我们很容易注意到 Looper.prepareMainLooper()，Looper.loop()这两句代码，具体他们都是做什么的，我们一个一个来分析，先来看看第一句源码："></a>我们很容易注意到 Looper.prepareMainLooper()，Looper.loop()这两句代码，具体他们都是做什么的，我们一个一个来分析，先来看看第一句源码：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">public static void prepareMainLooper() &#123;</div><div class="line">        prepare(false);</div><div class="line">        synchronized (Looper.class) &#123;</div><div class="line">            if (sMainLooper != null) &#123;</div><div class="line">                throw new IllegalStateException(&quot;The main Looper has already been prepared.&quot;);</div><div class="line">            &#125;</div><div class="line">            sMainLooper = myLooper();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="这里又调用了prepare-false-跟myLooper-方法"><a href="#这里又调用了prepare-false-跟myLooper-方法" class="headerlink" title="这里又调用了prepare(false)跟myLooper()方法"></a>这里又调用了prepare(false)跟myLooper()方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">private static void prepare(boolean quitAllowed) &#123;</div><div class="line">        if (sThreadLocal.get() != null) &#123;</div><div class="line">            throw new RuntimeException(&quot;Only one Looper may be created per thread&quot;);</div><div class="line">        &#125;</div><div class="line">        sThreadLocal.set(new Looper(quitAllowed));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">  public static @Nullable Looper myLooper() &#123;</div><div class="line">        return sThreadLocal.get();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="prepare-false-方法大家很熟悉了吧，其实它内部非常简单，就几行代码，这里就要涉及另一个类ThreadLocal了，这个类我们一样不详细说明了，感兴趣的小伙伴多去查询吧，ThreadLocal这个类是用来绑定当前线程的，我们这里就当做一个map使用即可，好，我们再来看prepare方法，先是判断当前线程是否已经绑定Looper了，如果绑定就抛出异常，这也就说明了，一个线程只能有一个Looper实例，如果没有绑定，我们就new出一个实例并且绑定到当前线程。"><a href="#prepare-false-方法大家很熟悉了吧，其实它内部非常简单，就几行代码，这里就要涉及另一个类ThreadLocal了，这个类我们一样不详细说明了，感兴趣的小伙伴多去查询吧，ThreadLocal这个类是用来绑定当前线程的，我们这里就当做一个map使用即可，好，我们再来看prepare方法，先是判断当前线程是否已经绑定Looper了，如果绑定就抛出异常，这也就说明了，一个线程只能有一个Looper实例，如果没有绑定，我们就new出一个实例并且绑定到当前线程。" class="headerlink" title="prepare(false)方法大家很熟悉了吧，其实它内部非常简单，就几行代码，这里就要涉及另一个类ThreadLocal了，这个类我们一样不详细说明了，感兴趣的小伙伴多去查询吧，ThreadLocal这个类是用来绑定当前线程的，我们这里就当做一个map使用即可，好，我们再来看prepare方法，先是判断当前线程是否已经绑定Looper了，如果绑定就抛出异常，这也就说明了，一个线程只能有一个Looper实例，如果没有绑定，我们就new出一个实例并且绑定到当前线程。"></a>prepare(false)方法大家很熟悉了吧，其实它内部非常简单，就几行代码，这里就要涉及另一个类ThreadLocal了，这个类我们一样不详细说明了，感兴趣的小伙伴多去查询吧，ThreadLocal这个类是用来绑定当前线程的，我们这里就当做一个map使用即可，好，我们再来看prepare方法，先是判断当前线程是否已经绑定Looper了，如果绑定就抛出异常，这也就说明了，一个线程只能有一个Looper实例，如果没有绑定，我们就new出一个实例并且绑定到当前线程。</h5><h5 id="myLooper-方法更简单了，就是从当前线程获取绑定的Looper实例。"><a href="#myLooper-方法更简单了，就是从当前线程获取绑定的Looper实例。" class="headerlink" title="myLooper()方法更简单了，就是从当前线程获取绑定的Looper实例。"></a>myLooper()方法更简单了，就是从当前线程获取绑定的Looper实例。</h5><h5 id="也就是说prepareMainLooper-方法就是创建一个Looper并与当前线程绑定，那么loop-方法又做了什么呢，源码如下："><a href="#也就是说prepareMainLooper-方法就是创建一个Looper并与当前线程绑定，那么loop-方法又做了什么呢，源码如下：" class="headerlink" title="也就是说prepareMainLooper()方法就是创建一个Looper并与当前线程绑定，那么loop()方法又做了什么呢，源码如下："></a>也就是说prepareMainLooper()方法就是创建一个Looper并与当前线程绑定，那么loop()方法又做了什么呢，源码如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">public static void loop() &#123;</div><div class="line">       final Looper me = myLooper();</div><div class="line">       if (me == null) &#123;</div><div class="line">           throw new RuntimeException(&quot;No Looper; Looper.prepare() wasn&apos;t called on this thread.&quot;);</div><div class="line">       &#125;</div><div class="line">       final MessageQueue queue = me.mQueue;</div><div class="line"></div><div class="line">       for (;;) &#123;</div><div class="line">           Message msg = queue.next(); // might block</div><div class="line">           if (msg == null) &#123;</div><div class="line">               // No message indicates that the message queue is quitting.</div><div class="line">               return;</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           try &#123;</div><div class="line">               msg.target.dispatchMessage(msg);</div><div class="line">               end = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis();</div><div class="line">           &#125; finally &#123;</div><div class="line">               if (traceTag != 0) &#123;</div><div class="line">                   Trace.traceEnd(traceTag);</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           msg.recycleUnchecked();</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h5 id="loop-方法我这里只贴出了需要的代码，这里第一句也是调用了myLooper-方法，也即获取当前线程绑定的Looper，而me-mQueue是什么呢，其实就是message内部的一个MessageQueue，我们看一下Looper的构造方法："><a href="#loop-方法我这里只贴出了需要的代码，这里第一句也是调用了myLooper-方法，也即获取当前线程绑定的Looper，而me-mQueue是什么呢，其实就是message内部的一个MessageQueue，我们看一下Looper的构造方法：" class="headerlink" title="loop()方法我这里只贴出了需要的代码，这里第一句也是调用了myLooper()方法，也即获取当前线程绑定的Looper，而me.mQueue是什么呢，其实就是message内部的一个MessageQueue，我们看一下Looper的构造方法："></a>loop()方法我这里只贴出了需要的代码，这里第一句也是调用了myLooper()方法，也即获取当前线程绑定的Looper，而me.mQueue是什么呢，其实就是message内部的一个MessageQueue，我们看一下Looper的构造方法：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">private Looper(boolean quitAllowed) &#123;</div><div class="line">      mQueue = new MessageQueue(quitAllowed);</div><div class="line">      mThread = Thread.currentThread();</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h5 id="就两句代码第一句就是创建了一个MessageQueue，第二句就是获取当前线程，由于一个线程只能有一个Looper实例，而一个Looper实例也只创建一个MessageQueue实例，所以一个线程只能绑定一个MessageQueue实例，好了，我们接着看loop-方法，获取message内部的messageQueue实例后，接着就是一个死循坏，当然这里说是死循坏并不恰当，后面我们会说明为什么，这个循坏里面不断从消息队列messageQueue中获取message实例，注意这句话might-bolck意思是说可能会阻塞，具体我们后面会说道，接下来，获取到message实例后会调用message-target-dispatchMessage-msg-方法，这里的target其实就是发送该message的handel看下message创建实例的方法："><a href="#就两句代码第一句就是创建了一个MessageQueue，第二句就是获取当前线程，由于一个线程只能有一个Looper实例，而一个Looper实例也只创建一个MessageQueue实例，所以一个线程只能绑定一个MessageQueue实例，好了，我们接着看loop-方法，获取message内部的messageQueue实例后，接着就是一个死循坏，当然这里说是死循坏并不恰当，后面我们会说明为什么，这个循坏里面不断从消息队列messageQueue中获取message实例，注意这句话might-bolck意思是说可能会阻塞，具体我们后面会说道，接下来，获取到message实例后会调用message-target-dispatchMessage-msg-方法，这里的target其实就是发送该message的handel看下message创建实例的方法：" class="headerlink" title="就两句代码第一句就是创建了一个MessageQueue，第二句就是获取当前线程，由于一个线程只能有一个Looper实例，而一个Looper实例也只创建一个MessageQueue实例，所以一个线程只能绑定一个MessageQueue实例，好了，我们接着看loop()方法，获取message内部的messageQueue实例后，接着就是一个死循坏，当然这里说是死循坏并不恰当，后面我们会说明为什么，这个循坏里面不断从消息队列messageQueue中获取message实例，注意这句话might bolck意思是说可能会阻塞，具体我们后面会说道，接下来，获取到message实例后会调用message.target.dispatchMessage(msg)方法，这里的target其实就是发送该message的handel看下message创建实例的方法："></a>就两句代码第一句就是创建了一个MessageQueue，第二句就是获取当前线程，由于一个线程只能有一个Looper实例，而一个Looper实例也只创建一个MessageQueue实例，所以一个线程只能绑定一个MessageQueue实例，好了，我们接着看loop()方法，获取message内部的messageQueue实例后，接着就是一个死循坏，当然这里说是死循坏并不恰当，后面我们会说明为什么，这个循坏里面不断从消息队列messageQueue中获取message实例，注意这句话might bolck意思是说可能会阻塞，具体我们后面会说道，接下来，获取到message实例后会调用message.target.dispatchMessage(msg)方法，这里的target其实就是发送该message的handel看下message创建实例的方法：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public static Message obtain(Handler h) &#123;</div><div class="line">       Message m = obtain();</div><div class="line">       m.target = h;</div><div class="line"></div><div class="line">       return m;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h5 id="很清楚这里创建message实例时要传入一个handler，也就是每一个message都要绑定发送它的handler。而handler-despatchMessage-message-方法都做了什么呢，源码如下："><a href="#很清楚这里创建message实例时要传入一个handler，也就是每一个message都要绑定发送它的handler。而handler-despatchMessage-message-方法都做了什么呢，源码如下：" class="headerlink" title="很清楚这里创建message实例时要传入一个handler，也就是每一个message都要绑定发送它的handler。而handler.despatchMessage(message)方法都做了什么呢，源码如下："></a>很清楚这里创建message实例时要传入一个handler，也就是每一个message都要绑定发送它的handler。而handler.despatchMessage(message)方法都做了什么呢，源码如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public void dispatchMessage(Message msg) &#123;</div><div class="line">       if (msg.callback != null) &#123;</div><div class="line">           handleCallback(msg);</div><div class="line">       &#125; else &#123;</div><div class="line">           if (mCallback != null) &#123;</div><div class="line">               if (mCallback.handleMessage(msg)) &#123;</div><div class="line">                   return;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">           handleMessage(msg);</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h5 id="可以看到其实就是调用了我们重写的handlerMessage-方法了，这也就是为什么我们创建handler时经常要重写handlerMessage方法了。好了我们这里先大概总结一下：首先先调用Looper-prepare方法创建一个Looper实例并且让该实例与当前线程绑定，以保证一个线程只有一个Looper实例，而创建Looper实例时，我们有在内部创建了一个消息队列MessageQueue实例，其次我们调用了Looper-loop方法，该方法内先获取当前线程绑定的Looper实例，并且从该Looper实例获取对应的消息队列，然后进入死循坏不断从消息队列中获取消息，一旦获取消息后，就调用发送该消息的handler的dispatchMessage方法处理该消息。那么消息是如何添加到对应的消息队列呢？"><a href="#可以看到其实就是调用了我们重写的handlerMessage-方法了，这也就是为什么我们创建handler时经常要重写handlerMessage方法了。好了我们这里先大概总结一下：首先先调用Looper-prepare方法创建一个Looper实例并且让该实例与当前线程绑定，以保证一个线程只有一个Looper实例，而创建Looper实例时，我们有在内部创建了一个消息队列MessageQueue实例，其次我们调用了Looper-loop方法，该方法内先获取当前线程绑定的Looper实例，并且从该Looper实例获取对应的消息队列，然后进入死循坏不断从消息队列中获取消息，一旦获取消息后，就调用发送该消息的handler的dispatchMessage方法处理该消息。那么消息是如何添加到对应的消息队列呢？" class="headerlink" title="可以看到其实就是调用了我们重写的handlerMessage()方法了，这也就是为什么我们创建handler时经常要重写handlerMessage方法了。好了我们这里先大概总结一下：首先先调用Looper.prepare方法创建一个Looper实例并且让该实例与当前线程绑定，以保证一个线程只有一个Looper实例，而创建Looper实例时，我们有在内部创建了一个消息队列MessageQueue实例，其次我们调用了Looper.loop方法，该方法内先获取当前线程绑定的Looper实例，并且从该Looper实例获取对应的消息队列，然后进入死循坏不断从消息队列中获取消息，一旦获取消息后，就调用发送该消息的handler的dispatchMessage方法处理该消息。那么消息是如何添加到对应的消息队列呢？"></a>可以看到其实就是调用了我们重写的handlerMessage()方法了，这也就是为什么我们创建handler时经常要重写handlerMessage方法了。好了我们这里先大概总结一下：首先先调用Looper.prepare方法创建一个Looper实例并且让该实例与当前线程绑定，以保证一个线程只有一个Looper实例，而创建Looper实例时，我们有在内部创建了一个消息队列MessageQueue实例，其次我们调用了Looper.loop方法，该方法内先获取当前线程绑定的Looper实例，并且从该Looper实例获取对应的消息队列，然后进入死循坏不断从消息队列中获取消息，一旦获取消息后，就调用发送该消息的handler的dispatchMessage方法处理该消息。那么消息是如何添加到对应的消息队列呢？</h5><h3 id="2、Hander源码分析"><a href="#2、Hander源码分析" class="headerlink" title="2、Hander源码分析"></a>2、Hander源码分析</h3><h5 id="我们平时使用handler发送消息有很多种，我们这里只分析其中一种sendMessage-Message-msg-，其他的类似-源码如下："><a href="#我们平时使用handler发送消息有很多种，我们这里只分析其中一种sendMessage-Message-msg-，其他的类似-源码如下：" class="headerlink" title="我们平时使用handler发送消息有很多种，我们这里只分析其中一种sendMessage(Message msg)，其他的类似,源码如下："></a>我们平时使用handler发送消息有很多种，我们这里只分析其中一种sendMessage(Message msg)，其他的类似,源码如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public final boolean sendMessage(Message msg)</div><div class="line">   &#123;</div><div class="line">       return sendMessageDelayed(msg, 0);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h5 id="其调用了sendMessageDelayed-msg-0-方法，其源码如下："><a href="#其调用了sendMessageDelayed-msg-0-方法，其源码如下：" class="headerlink" title="其调用了sendMessageDelayed(msg,0)方法，其源码如下："></a>其调用了sendMessageDelayed(msg,0)方法，其源码如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public final boolean sendMessageDelayed(Message msg, long delayMillis)</div><div class="line">  &#123;</div><div class="line">      if (delayMillis &lt; 0) &#123;</div><div class="line">          delayMillis = 0;</div><div class="line">      &#125;</div><div class="line">      return sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h5 id="其内部又调用了sendMessageAtTime方法："><a href="#其内部又调用了sendMessageAtTime方法：" class="headerlink" title="其内部又调用了sendMessageAtTime方法："></a>其内部又调用了sendMessageAtTime方法：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public boolean sendMessageAtTime(Message msg, long uptimeMillis) &#123;</div><div class="line">      MessageQueue queue = mQueue;</div><div class="line">      if (queue == null) &#123;</div><div class="line">          RuntimeException e = new RuntimeException(</div><div class="line">                  this + &quot; sendMessageAtTime() called with no mQueue&quot;);</div><div class="line">          Log.w(&quot;Looper&quot;, e.getMessage(), e);</div><div class="line">          return false;</div><div class="line">      &#125;</div><div class="line">      return enqueueMessage(queue, msg, uptimeMillis);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h5 id="这个方法也很简单，先是获取对应的消息队列，然后调用enqueueMessage方法，将message加入到该消息队列中："><a href="#这个方法也很简单，先是获取对应的消息队列，然后调用enqueueMessage方法，将message加入到该消息队列中：" class="headerlink" title="这个方法也很简单，先是获取对应的消息队列，然后调用enqueueMessage方法，将message加入到该消息队列中："></a>这个方法也很简单，先是获取对应的消息队列，然后调用enqueueMessage方法，将message加入到该消息队列中：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123;</div><div class="line">        msg.target = this;</div><div class="line">        if (mAsynchronous) &#123;</div><div class="line">            msg.setAsynchronous(true);</div><div class="line">        &#125;</div><div class="line">        return queue.enqueueMessage(msg, uptimeMillis);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h5 id="可以看到enqueueMessage方法先是将handler存到要发送的message中，再调用messageQueue-enqueueMessage方法，将消息加入到消息队列中，这样在Looper-loop启动后就可以获取到该message了。"><a href="#可以看到enqueueMessage方法先是将handler存到要发送的message中，再调用messageQueue-enqueueMessage方法，将消息加入到消息队列中，这样在Looper-loop启动后就可以获取到该message了。" class="headerlink" title="可以看到enqueueMessage方法先是将handler存到要发送的message中，再调用messageQueue.enqueueMessage方法，将消息加入到消息队列中，这样在Looper.loop启动后就可以获取到该message了。"></a>可以看到enqueueMessage方法先是将handler存到要发送的message中，再调用messageQueue.enqueueMessage方法，将消息加入到消息队列中，这样在Looper.loop启动后就可以获取到该message了。</h5><h5 id="好了，我们再来总结一下"><a href="#好了，我们再来总结一下" class="headerlink" title="好了，我们再来总结一下:"></a>好了，我们再来总结一下:</h5><ol>
<li>Looper.prepare()在本线程中创建一个Looper实例，在该实例中创建一个消息队列MessageQueue实例，因为一个线程只能有一个Looper实例，所以一个线程也就只能有一个消息队列。</li>
<li>Looper.loop()方法会让当前线程进入一个无限循坏中，不断从消息队列中获取message，当获取到message时，就交给发送该消息的handler处理，如果没获取到message则进入阻塞。</li>
<li>Hander实例创建时，会先获取到当前线程的Looper实例，然后通过该Looper实例获取到消息队列。</li>
<li>Hander.sendMessage方法，会给message绑定handler本身，然后加入到该线程的消息队列中。</li>
<li>消息机制是基于同一个线程而言的，也就是说同一个线程的handler只能发送message到同一个线程的消息队列中。<h5 id="四、后记"><a href="#四、后记" class="headerlink" title="四、后记"></a>四、后记</h5><h5 id="前面我们说过messagequeue-next方法会阻塞线程以及Looper-loop方法会进入死循坏中，那么这就涉及到另一个问题，在主线程中为什么死循坏不会造成ANR呢？"><a href="#前面我们说过messagequeue-next方法会阻塞线程以及Looper-loop方法会进入死循坏中，那么这就涉及到另一个问题，在主线程中为什么死循坏不会造成ANR呢？" class="headerlink" title="前面我们说过messagequeue.next方法会阻塞线程以及Looper.loop方法会进入死循坏中，那么这就涉及到另一个问题，在主线程中为什么死循坏不会造成ANR呢？"></a>前面我们说过messagequeue.next方法会阻塞线程以及Looper.loop方法会进入死循坏中，那么这就涉及到另一个问题，在主线程中为什么死循坏不会造成ANR呢？</h5><h5 id="首先，我们要理解什么是ANR-ANR是指某一事件长时间未得到相应。比如说，我们先点击某一个button的点击事件，再点击另一个button的点击事件，假如这里不牵扯多线程问题，如果第一个button有耗时操作超过5s，那么第二个button的点击事件，只能在消息队列中等候，当长时间未轮到第二个button的点击事件的message时，就会报ANR。既然知道了什么是ANR，那么为什么next方法阻塞线程时不会报ANR呢，其实这里的阻塞并不是我们平时说的阻塞，我们可以理解为休眠，当消息队列中没有消息时，线程会进入休眠状态，当来新的消息时，会被唤醒，其实在主线程中我们可以看到activity等的生命周期都在一个继承Handler的类H中进行管理的，而如果主线程并不是死循环的话，当走完生命周期，那么这个线程也就结束了，我们的程序也就退出去了，所以这里设计成死循环也是为了让程序一直运行。"><a href="#首先，我们要理解什么是ANR-ANR是指某一事件长时间未得到相应。比如说，我们先点击某一个button的点击事件，再点击另一个button的点击事件，假如这里不牵扯多线程问题，如果第一个button有耗时操作超过5s，那么第二个button的点击事件，只能在消息队列中等候，当长时间未轮到第二个button的点击事件的message时，就会报ANR。既然知道了什么是ANR，那么为什么next方法阻塞线程时不会报ANR呢，其实这里的阻塞并不是我们平时说的阻塞，我们可以理解为休眠，当消息队列中没有消息时，线程会进入休眠状态，当来新的消息时，会被唤醒，其实在主线程中我们可以看到activity等的生命周期都在一个继承Handler的类H中进行管理的，而如果主线程并不是死循环的话，当走完生命周期，那么这个线程也就结束了，我们的程序也就退出去了，所以这里设计成死循环也是为了让程序一直运行。" class="headerlink" title="首先，我们要理解什么是ANR,ANR是指某一事件长时间未得到相应。比如说，我们先点击某一个button的点击事件，再点击另一个button的点击事件，假如这里不牵扯多线程问题，如果第一个button有耗时操作超过5s，那么第二个button的点击事件，只能在消息队列中等候，当长时间未轮到第二个button的点击事件的message时，就会报ANR。既然知道了什么是ANR，那么为什么next方法阻塞线程时不会报ANR呢，其实这里的阻塞并不是我们平时说的阻塞，我们可以理解为休眠，当消息队列中没有消息时，线程会进入休眠状态，当来新的消息时，会被唤醒，其实在主线程中我们可以看到activity等的生命周期都在一个继承Handler的类H中进行管理的，而如果主线程并不是死循环的话，当走完生命周期，那么这个线程也就结束了，我们的程序也就退出去了，所以这里设计成死循环也是为了让程序一直运行。"></a>首先，我们要理解什么是ANR,ANR是指某一事件长时间未得到相应。比如说，我们先点击某一个button的点击事件，再点击另一个button的点击事件，假如这里不牵扯多线程问题，如果第一个button有耗时操作超过5s，那么第二个button的点击事件，只能在消息队列中等候，当长时间未轮到第二个button的点击事件的message时，就会报ANR。既然知道了什么是ANR，那么为什么next方法阻塞线程时不会报ANR呢，其实这里的阻塞并不是我们平时说的阻塞，我们可以理解为休眠，当消息队列中没有消息时，线程会进入休眠状态，当来新的消息时，会被唤醒，其实在主线程中我们可以看到activity等的生命周期都在一个继承Handler的类H中进行管理的，而如果主线程并不是死循环的话，当走完生命周期，那么这个线程也就结束了，我们的程序也就退出去了，所以这里设计成死循环也是为了让程序一直运行。</h5></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.coolcoolcoder.com/c_night/2017/10/16/other/Hexo安装配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CoolYellow">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="coolyellow的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/16/other/Hexo安装配置/" itemprop="url">Hexo安装配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-16T21:46:30+08:00">
                2017-10-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Hexo简介"><a href="#Hexo简介" class="headerlink" title="Hexo简介"></a>Hexo简介</h3><h5 id="Hexo是一个快速、简洁且高效的博客框架。Hexo使用Markdown解析文章，在几秒内，即可利用靓丽的主题生成静态网页。"><a href="#Hexo是一个快速、简洁且高效的博客框架。Hexo使用Markdown解析文章，在几秒内，即可利用靓丽的主题生成静态网页。" class="headerlink" title="Hexo是一个快速、简洁且高效的博客框架。Hexo使用Markdown解析文章，在几秒内，即可利用靓丽的主题生成静态网页。"></a>Hexo是一个快速、简洁且高效的博客框架。Hexo使用Markdown解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</h5><h3 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h3><h5 id="1-安装git-sudo-apt-get-install-git-core"><a href="#1-安装git-sudo-apt-get-install-git-core" class="headerlink" title="1.安装git : sudo apt-get install git-core"></a>1.安装git : sudo apt-get install git-core</h5><h5 id="2-安装NodeJs"><a href="#2-安装NodeJs" class="headerlink" title="2.安装NodeJs"></a>2.安装NodeJs</h5><h5 id="3-安装Hexo"><a href="#3-安装Hexo" class="headerlink" title="3.安装Hexo"></a>3.安装Hexo</h5><h5 id="4-生成SSH并添加到github"><a href="#4-生成SSH并添加到github" class="headerlink" title="4.生成SSH并添加到github"></a>4.生成SSH并添加到github</h5><h5 id="5-部署项目"><a href="#5-部署项目" class="headerlink" title="5.部署项目"></a>5.部署项目</h5><h5 id="6-上传到github"><a href="#6-上传到github" class="headerlink" title="6.上传到github"></a>6.上传到github</h5><h5 id="7-绑定个人域名"><a href="#7-绑定个人域名" class="headerlink" title="7.绑定个人域名"></a>7.绑定个人域名</h5><h5 id="8-修改及配置主题"><a href="#8-修改及配置主题" class="headerlink" title="8.修改及配置主题"></a>8.修改及配置主题</h5><h5 id="9-添加RSS"><a href="#9-添加RSS" class="headerlink" title="9.添加RSS"></a>9.添加RSS</h5><h5 id="10-添加评论"><a href="#10-添加评论" class="headerlink" title="10.添加评论"></a>10.添加评论</h5><h3 id="二、注意事项"><a href="#二、注意事项" class="headerlink" title="二、注意事项"></a>二、注意事项</h3><ol>
<li>当使用代码块时，要在开始的```之后加入空格跟回车，否则代码块区域会有错误。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">CoolYellow</p>
              <p class="site-description motion-element" itemprop="description">c_night</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CoolYellow</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
